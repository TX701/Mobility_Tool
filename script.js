mapboxgl.accessToken = "pk.eyJ1IjoicnN0dmRldiIsImEiOiJjbWc4OGhzcjgwNTNxMmtwdGhlMWR3eDN2In0.Arna-I1oQmDjHKX-tmUIyg";
let center = [-83.211269, 42.672954] // longitute, latitude
let bounds = [[-83.255980, 42.625370], [-83.151353, 42.704894]];

let wholeWord = [[-83.23946,42.6927258],[-83.238945,42.6925996],[-83.2387733,2.6394312],[-83.1568909,42.6389258],[-83.1570625,42.6941144],[-83.23946,42.6927258]]
let coordForGeoJson = [[-83.19413, 42.68034], [-83.19321, 42.66018], [-83.19926, 42.66002], [-83.20724, 42.65725], [-83.21027, 42.65613], [-83.21299, 42.65534], [-83.21388, 42.65505], [-83.2145, 42.65479], [-83.21503, 42.65453], [-83.21601, 42.65417], [-83.21693, 42.65391], [-83.2178, 42.65366], [-83.21843, 42.65347], [-83.21923, 42.65323], [-83.21976, 42.65311], [-83.21972, 42.65348], [-83.2194, 42.65417], [-83.21845, 42.65559], [-83.21793, 42.65638], [-83.21765, 42.65703], [-83.21741, 42.65776], [-83.21721, 42.65851], [-83.21711, 42.65937], [-83.21717, 42.66044], [-83.21723, 42.6609], [-83.21737, 42.66157], [-83.21759, 42.6621], [-83.21791, 42.6628], [-83.2182, 42.6633], [-83.21897, 42.66484], [-83.21923, 42.66533], [-83.21957, 42.66612], [-83.21978, 42.66668], [-83.21986, 42.66756], [-83.21998, 42.6686], [-83.22014, 42.67004], [-83.22027, 42.67176], [-83.22029, 42.67243], [-83.22088, 42.67889], [-83.21978, 42.67887], [-83.21752, 42.67881], [-83.21677, 42.67885], [-83.2153, 42.67886], [-83.21451, 42.67899], [-83.21328, 42.67926], [-83.21236, 42.67955], [-83.2114, 42.67985], [-83.21036, 42.68003], [-83.20935, 42.68003], [-83.20835, 42.68005], [-83.20641, 42.6801], [-83.20196, 42.68019], [-83.20196, 42.68019], [-83.1946, 42.68031]];
let testCoord = [[-83.2208079, 42.6788495], [-83.2176751, 42.6788416], [-83.2162160, 42.6788022], [-83.2148963, 42.6788969], [-83.2133728, 42.6792125], [-83.2122195, 42.6795716], [-83.2108998, 42.6799188], [-83.2101166, 42.6800135], [-83.2087648, 42.6800845], [-83.2056320, 42.6800759], [-83.2000422, 42.6801941], [-83.1941682, 42.6803006], [-83.1938517, 42.6749225], [-83.1936157, 42.6693103], [-83.1932080, 42.6601816], [-83.1943560, 42.6601027], [-83.1967700, 42.6600790], [-83.1994092, 42.6600457], [-83.2040870, 42.6582735], [-83.2095748, 42.6563868], [-83.2148427, 42.6545750], [-83.2196492, 42.6530553], [-83.2197887, 42.6532605], [-83.2196170, 42.6537263], [-83.2189840, 42.6547210], [-83.2182759, 42.6557631], [-83.2175785, 42.6570736], [-83.2171762, 42.6583493], [-83.2170367, 42.6594387], [-83.2171762, 42.6609386], [-83.2173693, 42.6617261], [-83.2179487, 42.6629023], [-83.2184315, 42.6638337], [-83.2191074, 42.6651519], [-83.2193649, 42.6659412], [-83.2197887, 42.6669199], [-83.2198745, 42.6681039], [-83.2200676, 42.6696351], [-83.2205075, 42.6742167], [-83.2207865, 42.6788255]];
let counterClockWise = [[-83.1946, 42.68031], [-83.20196, 42.68019], [-83.20196, 42.68019], [-83.20641, 42.6801], [-83.20835, 42.68005], [-83.20935, 42.68003], [-83.21036, 42.68003], [-83.2114, 42.67985], [-83.21236, 42.67955], [-83.21328, 42.67926], [-83.21451, 42.67899], [-83.2153, 42.67886], [-83.21677, 42.67885], [-83.21752, 42.67881], [-83.21978, 42.67887], [-83.22088, 42.67889], [-83.22029, 42.67243], [-83.22027, 42.67176], [-83.22014, 42.67004], [-83.21998, 42.6686], [-83.21986, 42.66756], [-83.21978, 42.66668], [-83.21957, 42.66612], [-83.21923, 42.66533], [-83.21897, 42.66484], [-83.2182, 42.6633], [-83.21791, 42.6628], [-83.21759, 42.6621], [-83.21737, 42.66157], [-83.21723, 42.6609], [-83.21717, 42.66044], [-83.21711, 42.65937], [-83.21721, 42.65851], [-83.21741, 42.65776], [-83.21765, 42.65703], [-83.21793, 42.65638], [-83.21845, 42.65559], [-83.2194, 42.65417], [-83.21972, 42.65348], [-83.21976, 42.65311], [-83.21923, 42.65323], [-83.21843, 42.65347], [-83.2178, 42.65366], [-83.21693, 42.65391], [-83.21601, 42.65417], [-83.21503, 42.65453], [-83.2145, 42.65479], [-83.21388, 42.65505], [-83.21299, 42.65534], [-83.21027, 42.65613], [-83.20724, 42.65725], [-83.19926, 42.66002], [-83.19321, 42.66018], [-83.19413, 42.68034]]

let urlTest = "http://localhost:5678/webhook-test/829cc1f7-0682-42cc-975e-7024ea52e8ba";
let urlProduction = "http://localhost:5678/webhook/829cc1f7-0682-42cc-975e-7024ea52e8ba";

fetch(urlProduction)
  .then(response => {
    if (!response.ok) {
      throw new Error(`Error: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    constructPinPoints(data);
  })
  .catch(error => {
    console.error('Error:', error);
});

const constructPinPoints = (data) => {
  data.forEach(element => {
    let marker = new mapboxgl.Marker().setLngLat([element.Longitude, element.Latitude]).addTo(map);
    console.log(marker);
  });
}

const map = new mapboxgl.Map({
  container: "map",
  center: center, 
  style: "mapbox://styles/mapbox/standard",
  config: {
    basemap: {
      // lightPreset: "dusk",
    }
  },
  zoom: 16
});

map.on("load", () => {
    map.addSource("Oakland", {
        "type": "geojson",
        "data": {
            "type": "Feature",
            "geometry": {
                "type": "Polygon",
                "coordinates": [
                  counterClockWise
                ]
            }
        }
    });

    map.addLayer({
        "id": "Oakland-Polygon",
        "type": "line",
        "source": "Oakland",
        "paint": {
          "line-color": "#0000FF",
          "line-width": 3
        }
    });
});